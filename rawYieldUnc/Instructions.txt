**** GENERAL DESCRIPTION ****
For each pT bin defined by the user, the code evaluates a series of variations of the fit condition of the D-meson invariant mass distribution, retrieving the mean and the RMS of the yields from each variations.
In case of the efficiency scaling approach, the RMS of the yields for each (efficiency scaled) pT(jet) bin is already considered as the absolute yield uncertainty on that bin of the jet spectrum. The relative uncertainty is simply the absolute uncertainty divided by the mean value of the yield.
In case of the sideband scaling, for each fit variation in a given pT(D) bin, the value of Gaussian mean, sigma and background in the signal region are stored. Then, to build the jet pT spectrum, a fixed, user-defined amount (N) of variations are chosen, independently and randomly in each pT(D) bin, and for each case the corresponding bkg-subtracted jet spectrum (using the signal region, sideband region and bkg normalization factor stored for that particular variation) as in the standard analysis. The RMS of the N variations of the jet yield in each pT bin is considered as the absolute yield uncertainty on that bin. Again, the relative uncertainty is simply the absolute uncertainty divided by the mean value of the yield.

**** EXECUTION ****
- Before the execution, the steering macro needs to be configured, by setting the proper values in the SetInputParametersDzero / SetInputParametersDstar methods.
  In particular:
  -> Set the names of input files, trees/THnSparse, etc.
  -> Set the number and edges of pT(D) bins pT(jet) bins. For the Dstar, the latter are used only for the efficiency scale method, since in the Sb subtraction method the pT(jet) bins are already determined by the THnSparse projections (unless you call SetRebinSpectrumIfSBApproach(kTRUE), see later on).
  -> Set the D efficiency values for each pT(D) bin
  -> For the Dzero: set the value of min, max and bin width for the invariant mass plots (for the Dstar, these come automatically from the THnSparse projections).
  -> For the Dstar, SB approach: choose whether to rebin the jet pT spectrum with the user-defined binning (calling SetRebinSpectrumIfSBApproach(kTRUE)) orkeep the THnSparse binning
  -> Define the configuration of the trials (look at the next section for details).
- To execute the code, the class has to be compiled first, and the steering macro loaded:
   gROOT->LoadMacro("AliDJetRawYieldUncertainty.cxx++")
   .L ExtractDJetRawYieldUncertainty.C
- Then, independently of the approach chosen, the method EvaluateBinPerBinUncertainty has to be run for each pT bin (i.e. pT(jet) for eff.scale method, pT(D) for Sb subtraction method). ptmin and ptmax are the pT limits of the bin to be looked at; for the Dstar, the z range for the projections can be also varied by setting zmin and zmax.
- Finally, the yield uncertainty is obtained by executing (once) the method ExtractDJetRawYieldUncertainty. In case of the SB subtraction approach, nTrials is the number of random variations to be picked from the total list of variations performed in the pT(D) bins, in order to get the final uncertainty.
- The code produces a .root file with the absolute value of the yield uncertainty + a .root file with the mean of the yield from the variations + its relative uncertainty.
NOTE: In case a reflection template has to be added to the invariant mass fit function (Dzero analysis), refer to the reflection section below.

**** CONFIGURATION OF THE TRIALS ****
There's no precise recipe (even in D2H on how to define the variations, and on their number). In the following, some information on the different possibilities, which can be enabled via the steering macro, are given.

* sigmafixed --> MC value of the sigma for the pT bin under exam. Needs to be set carefully, for each pT bin you look at.

* chi2cut --> upper threshold of the chi^2/ndf for the fit. If the fit is worse than this threshold, is excluded from further operations.

* meansigmaVar[6] = {kTRUE,kTRUE,kTRUE,kTRUE,kTRUE,kTRUE}; --> Variations of the mean and sigma configuration, can be activated or excluded.
	From left to right: fixed sigma, fixed sigma (increased by 15%), fixed sigma (decreased by 15%), free mean and sigma, free sigma and fixed mean, fixed mean and sigma


* bkgVar[8] = {kTRUE,kFALSE,kTRUE,kFALSE,kFALSE,kFALSE,kFALSE,kFALSE}; --> Variations of the mean and sigma configuration, can be activated or excluded.
	From left to right: exponential, straight line, pol2, pol3, pol4, pol5, power law, power law*exponential

* nRebinSteps=2;  --> Variations of the binning of the mass spectrum. Set the number of cases and the rebin values in the array
  rebinStep[2]={1,2};

* nMinMassSteps=2;  --> Variations of the lower edge of the fit range. Set the number of cases and the values in the array
  minMassStep[2]={1.72,1.74};

* nMaxMassSteps=2;  --> Variations of the lower edge of the fit range. Set the number of cases and the values in the array
  maxMassStep[2]={2.00,2.03};

* nStepsBC=2;  --> If nStepsBC=0, independently of what you set in thearray, skips evaluation of yield via bin counting. Otherwise, enables it, in the number of sigma from the peak center set in the array.
  nSigmasBC[2]={3.5,4.0};

* The following is a technicality for the MultiTrial code, just set nmask to the product of active variations of meansigmaVar and bkgVar (12 in this example) and fill the array mask with an equivalent amount of 1's.
  Int_t nmask = 12;
  Bool_t mask[12] =    {1,1,   // fixed sigma (Expo, Lin, Pol2, Pol3, Pol4, Pol5, PowLaw, PowLaw*Exp)
			1,1,   // fixed sigma+15%
			1,1,   // fixed sigma-15%
			1,1,   // free sigma, free mean
			1,1,   // free sigma, fixed mean
			1,1};  // fixed mean, fixed sigma

**** NOTES ****
- After executing the EvaluateBinPerBinUncertainty method, for each bin, always check the control canvas which is printed by the code, considering that:
--> If there are fits with chi2 over the value set in the macro, these will be chopped, and you'll get empty bins. This will often happen in case a not suitable bkg function is chosen
--> If the sigmafixed value is not properly set, not only you will bias the variations done with the fixed sigma, but you could get empty bins since the cases with a fit sigma >2, or <0.5 from the sigmafixed value will be chopped.
- For the SB subtraction approach with the method ExtractDJetRawYieldUncertainty, in building the final uncertatinty never set a value of random variations greater than the minimum number of succesful variations for the varios pT(D) bins analysed. This, unless you allow repetition of randomly chosen trials, via allowRepet=kTRUE, which I won't anyway suggest.

**** REFLECTIONS (Dzero only) ****
The code implements the possibility of setting a template for the fitting of the reflection component of the invariant mass distribution in a given pT (D or jet) bin.
This feature enters in play only during the bin-by-bin fitting phase (when calling the EvaluateBinPerBinUncertainty function), and can be enabled by setting as kTRUE the flag �refl� in the function arguments.
The ingredients needed are:
- A 1D histogram with the template distribution in the pT bin under analysis
- The reflection/true signal ratio in the mass fit range OR the true signal mass distribution in the pT bin under analysis (the ratio can be indeed fixed by hand, or evaluated by the reflection and true signal histograms).
An example of these plots (in several pT bins) is given as an attachment in the jira ticket (file reflections_fitted_DoubleGaus.root). Note that these histograms are (strongly) pT-dependent. It�s not mandatory that these histograms have the same binning and mass range of the data mass distribution.
The input filenames and the histogram names are set in the SetInputParameterDzero section, together with:
- The value of the reflection/true signal ratio, if fixed from the user (first argument of SetValueOfReflOverSignal)
- The mass fit range of the bin under study, to automatically evaluate that ratio from the input histograms (in this case the first argument has to be set to -1)
After these setting.
It is possible to smoothen the reflection templates retrived from the MC analysis using the FitReflDistr in the steering macro: it needs an input file with the templats for each pTbin inside (named �histRefl_N�, with N the ptbin number from 0 to nbins), the number of pTbins (nbins) and a distribution to be used as guideline for the template smoothing (choose among DoubleGaus, pol3, pol6, gaus � with the first as default).
This function can be used also to produce template variations (using different guide functions), which, together with variations of the refl/true signal ratio (by fixing it externally to different values) can help in evaluating the impact of the reflection template on the yield extraction, and its stability against template variations.